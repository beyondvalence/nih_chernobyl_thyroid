! Figure 1 and 2
! Model building for all nodules, whole dose range

new @

names 
IDN	
byear AGE_EXM	AGE_EXP	YEAR_EXM 
SEX_L	
OBL_M	OBL_86	UR_RUR	ur_rur86
thnod_prev	max_size nod_sz nod_sz3 thcount nod_neohc nod_neo
tc	prevcases FA_PREV 
DOSE_GYAV_S		
IODINE	tvolume TSH	TG	atg 
SMOKE_F	VITAM_F		
AIT_TOTF goiter_df_pal NDG_RELF ANY_FHF1
Cytology CytologyRecomend Operat OperatRecomend RefOnko fnb
@

skip 1 @

input 'C:\reb\chernobyl_thyroid\Data\dose_tnprev_belam_exclude1.csv' @
Input from C:\reb\chernobyl_thyroid\Data\dose_tnprev_belam_exclude1.csv

       11422 records read       11421 records used
                                    1 records rejected

40 variables defined  At least 500 additional variables can be created.



tran dgy=dose_gyav_s;
     dgysq=dgy*dgy;
     ex2=(age_exp-2);
     ex4=(age_exp-4);
     ex5=(age_exp-5);
     ex8=(age_exp-8);
     ex8sq=ex8*ex8;
     age21=(age_exm-21);
     age21sq=age21*age21;
     lage21 = log(age_exm/21) ;
     lage21sq = lage21^2 ;
     tvol13=(tvolume-13);
     tvol13sq=tvol13*tvol13;
     yob1983=(byear-1983);

     if any_fhf1==-1 then any_fhf1=2 !2 recoded to missing
     endif; 

     if smoke_f==-1 then smoke_f=2
     endif;
     
     if ismiss(goiter_df_pal)==1 then goiter_df_pal=2
     endif;


     if obl_m==1 then obl_mn=2 !Gomel
     elif obl_m==2 or obl_m==4 then obl_mn=1 !Minsk
     else obl_mn=3 !Mogilev and others
     endif;

     if obl_86==1 then obl_86n=2 !Gomel
     elif obl_86==2 or obl_86==4 then obl_86n=1 !Minsk
     else obl_86n=3 !Mogilev and others
     endif;

     if ur_rur86==1 then ur_rur86n=1 !Rural
     elif ur_rur86==2 or ur_rur86==3 or ur_rur86==4 then ur_rur86n=2 !Urban
     endif;

     if tvolume>=18 and sex_l==1 then tvlarge=1 !Thyroid enlargement for women
     elif tvolume>=25 and sex_l==0 then tvlarge=1  !Thyroid enlargement for men
     else tvlarge=0 !Normal thyroid
     endif;

     iod100=(iodine-100);
     iod60=(iodine-60);
     iodinen=iodine;
     if ismiss(iodine)==1 then iodinen=9999
     endif; 


@
 
levels   
SEX_L	 
OBL_M	obl_mn OBL_86 obl_86n	UR_RUR	ur_rur86 ur_rur86n
thnod_prev nod_sz nod_sz3 thcount nod_neohc nod_neo
tc	prevcases FA_PREV 
SMOKE_F	VITAM_F		
AIT_TOTF goiter_df_pal NDG_RELF ANY_FHF1
Cytology CytologyRecomend Operat OperatRecomend RefOnko fnb
tvlarge 
@

SEX_L has 2 levels from 0 to 1
OBL_M has 5 levels from 1 to 5
obl_mn has 3 levels from 1 to 3
OBL_86 has 8 levels from 1 to 8
obl_86n has 3 levels from 1 to 3
UR_RUR has 2 levels from 0 to 1
ur_rur86 has 4 levels from 1 to 4
ur_rur86n has 2 levels from 1 to 2
thnod_prev has 2 levels from 0 to 1
nod_sz has 3 levels from 0 to 2
nod_sz3 has 4 levels from 0 to 3
thcount has 5 levels from 0 to 4
nod_neohc has 2 levels from 0 to 1
nod_neo has 2 levels from 0 to 1
tc has 4 levels from 0 to 3
prevcases has 2 levels from 0 to 1
FA_PREV has 2 levels from 0 to 1
SMOKE_F has 3 levels from 0 to 2
VITAM_F has 2 levels from 0 to 1
AIT_TOTF has 3 levels from -1 to 1
goiter_df_pal has 3 levels from 0 to 2
NDG_RELF has 3 levels from -1 to 1
ANY_FHF1 has 3 levels from 0 to 2
Cytology has 2 levels from 1 to 2
CytologyRecomend has 2 levels from 0 to 1
Operat has 2 levels from 1 to 2
OperatRecomend has 2 levels from 0 to 1
RefOnko has 4 levels from 0 to 3
fnb has 3 levels from 1 to 3
tvlarge has 2 levels from 0 to 1

categ byear as dobyrct </1973/ 1978/ 1983/ 1987/ > @
dobyrct has 5 levels from 1 to 5

categ age_exm as agect </ 18/ 25/ > @
agect has 3 levels from 1 to 3

categ age_exp as exct </2/5/ > @ 
exct has 3 levels from 1 to 3

categ age_exp as exct4 </1/2/5 > @ 
exct4 has 4 levels from 1 to 4

categ year_exm as yearexmct </ 1998/ 1999/ 2000/ 2001/> @
yearexmct has 5 levels from 1 to 5

categ tvolume as tvct </ 8/ 10/ 14/ > @
tvct has 4 levels from 1 to 4

categ iodinen as iodct </20/9998> @
iodct has 3 levels from 1 to 3

categ dgy as dct7  </ 0.1000/ 0.2500/ 0.500/ 1.000/ 2.000/ 4.000/> @
dct7 has 7 levels from 1 to 7


@

cases thnod_prev @

freq  thnod_prev @

  FOR: thnod_prev
  Level     Freq     %      Cum %
      0       10540   92.29    92.29
      1         881    7.71   100.00
  Total       11421



! Background
! A priori: sex, attained age, log age at exposure 
! To examine: UR_RUR, oblast, iodine,  tvlarge, goiter_df_pal,any_fhf1, vitam_f

!Urban rural
nomodel @
logl 0 sex_l lage21  ex5 @
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6737.997
             2     0     6043.235
             3     0     5978.664
             4     0     5977.166
             5     0     5977.166
             6     0     5977.166

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.830      0.1116     -25.36    < 0.001
 3 SEX_L_1..................         0.4464     0.07256      6.152    < 0.001
 4 lage21...................          3.050      0.6062      5.031    < 0.001
 5 ex5......................       -0.06054     0.02902     -2.086      0.037

Linear term 1
 6 dgy......................         0.4421     0.08793      5.027    < 0.001

            Records used        11421

                Deviance     5977.166
                     AIC     5987.166
            Pearson Chi2     11222.97      Degrees of freedom   11416



null@
logl 0 +UR_RUR  @ fit@ 
          Iter  Step      Deviance

             0     0     5977.166
             1     0     5969.152
             2     0     5969.143
             3     0     5969.143

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.986      0.1258     -23.74    < 0.001
 3 SEX_L_1..................         0.4421     0.07261      6.089    < 0.001
 5 UR_RUR_1.................         0.2147     0.07657      2.804    0.00504
 6 lage21...................          3.086      0.6073      5.082    < 0.001
 7 ex5......................       -0.06127     0.02906     -2.108      0.035

Linear term 1
 8 dgy......................         0.5153      0.1012      5.089    < 0.001

            Records used        11421

                Deviance     5969.143
                     AIC     5981.143
            Pearson Chi2     11244.17      Degrees of freedom   11415



lrt@

             LR statistic       8.022      Degrees of freedom      1
                  P value     0.00462

logl 0 -UR_RUR +ur_rur86n  @ fit@ 
          Iter  Step      Deviance

             0     0     5990.663
             1     0     5976.075
             2     0     5975.983
             3     0     5975.982

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.881      0.1218     -23.66    < 0.001
 3 SEX_L_1..................         0.4473     0.07258      6.163    < 0.001
 5 ur_rur86n_2..............        0.08550     0.07895      1.083      0.279
 6 lage21...................          3.066      0.6068      5.052    < 0.001
 7 ex5......................       -0.05988     0.02903     -2.063     0.0392

Linear term 1
 8 dgy......................         0.4764     0.09877      4.824    < 0.001

            Records used        11421

                Deviance     5975.982
                     AIC     5987.982
            Pearson Chi2     11232.73      Degrees of freedom   11415



lrt@

!Oblast

             LR statistic       1.183      Degrees of freedom      1
                  P value       0.277

nomodel @
logl 0 sex_l lage21  ex5 UR_RUR@
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6734.688
             2     0     6036.629
             3     0     5970.751
             4     0     5969.144
             5     0     5969.143
             6     0     5969.143

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.986      0.1258     -23.74    < 0.001
 3 SEX_L_1..................         0.4421     0.07261      6.089    < 0.001
 5 UR_RUR_1.................         0.2147     0.07657      2.804    0.00504
 6 lage21...................          3.086      0.6073      5.082    < 0.001
 7 ex5......................       -0.06127     0.02906     -2.108      0.035

Linear term 1
 8 dgy......................         0.5153      0.1012      5.089    < 0.001

            Records used        11421

                Deviance     5969.143
                     AIC     5981.143
            Pearson Chi2     11244.17      Degrees of freedom   11415



null@
logl 0 +obl_mn  @ fit@ 
          Iter  Step      Deviance

             0     0     5969.143
             1     0     5967.071
             2     0     5967.066
             3     0     5967.066

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.990      0.1449     -20.64    < 0.001
 3 SEX_L_1..................         0.4417     0.07263      6.081    < 0.001
 5 UR_RUR_1.................         0.2173       0.079      2.751    0.00595
 7 obl_mn_2.................        0.04685     0.09172     0.5108      > 0.5
 8 obl_mn_3.................        -0.1235      0.1374    -0.8985      0.369
 9 lage21...................          3.120      0.6106      5.109    < 0.001
10 ex5......................       -0.06339     0.02914     -2.176     0.0296

Linear term 1
11 dgy......................         0.4964      0.1017      4.881    < 0.001

            Records used        11421

                Deviance     5967.066
                     AIC     5983.066
            Pearson Chi2     11236.71      Degrees of freedom   11413



lrt@

             LR statistic       2.077      Degrees of freedom      2
                  P value       0.354

logl 0 -obl_mn +obl_86n  @ fit@ 
          Iter  Step      Deviance

             0     0     5969.450
             1     0     5963.963
             2     0     5963.935
             3     0     5963.935

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.029      0.1605     -18.88    < 0.001
 3 SEX_L_1..................         0.4413     0.07263      6.076    < 0.001
 5 UR_RUR_1.................         0.2193     0.07812      2.808    0.00499
 7 obl_86n_2................         0.1164      0.1186     0.9818      0.326
 8 obl_86n_3................        -0.1747       0.169     -1.034      0.301
 9 lage21...................          3.179      0.6097      5.214    < 0.001
10 ex5......................       -0.06653     0.02916     -2.281     0.0225

Linear term 1
11 dgy......................         0.4665     0.09958      4.684    < 0.001

            Records used        11421

                Deviance     5963.935
                     AIC     5979.935
            Pearson Chi2     11223.26      Degrees of freedom   11413



lrt@


!Iodine

             LR statistic       5.209      Degrees of freedom      2
                  P value      0.0740

select  ismiss(iodine)==0@
11275 records to be used


nomodel @
logl 0 sex_l lage21  ex5 ur_rur  @
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15630.469
             1     0     6661.144
             2     0     5975.061
             3     0     5910.992
             4     0     5909.491
             5     0     5909.490
             6     0     5909.490

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

Using ismiss(iodine)==0

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.991      0.1266     -23.63    < 0.001
 3 SEX_L_1..................         0.4495     0.07293      6.163    < 0.001
 5 UR_RUR_1.................         0.2111     0.07689      2.746    0.00604
 6 lage21...................          3.001      0.6108      4.913    < 0.001
 7 ex5......................       -0.05802     0.02926     -1.983     0.0474

Linear term 1
 8 dgy......................         0.5125      0.1013      5.058    < 0.001

            Records used        11275

                Deviance      5909.49
                     AIC      5921.49
            Pearson Chi2     11096.87      Degrees of freedom   11269



null@
logl 0 +iodine  @ fit@ 
          Iter  Step      Deviance

             0     0     5909.490
             1     0     5909.442
             2     0     5909.442

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

Using ismiss(iodine)==0

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.983      0.1313     -22.72    < 0.001
 3 SEX_L_1..................         0.4496     0.07294      6.164    < 0.001
 5 UR_RUR_1.................         0.2133     0.07757       2.75    0.00595
 6 lage21...................          3.008      0.6117      4.918    < 0.001
 7 ex5......................       -0.05835     0.02929     -1.992     0.0464
 8 IODINE...................     -8.199e-05   0.0003741    -0.2192      > 0.5

Linear term 1
 9 dgy......................         0.5125      0.1013      5.058    < 0.001

            Records used        11275

                Deviance     5909.442
                     AIC     5923.442
            Pearson Chi2     11095.91      Degrees of freedom   11268



lrt@

             LR statistic     0.04844      Degrees of freedom      1
                  P value      > 0.50

noselect@

!Thyroid volume enlargement

11421 records to be used

nomodel @
logl 0 sex_l lage21  ex5 ur_rur@
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6734.688
             2     0     6036.629
             3     0     5970.751
             4     0     5969.144
             5     0     5969.143
             6     0     5969.143

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.986      0.1258     -23.74    < 0.001
 3 SEX_L_1..................         0.4421     0.07261      6.089    < 0.001
 5 UR_RUR_1.................         0.2147     0.07657      2.804    0.00504
 6 lage21...................          3.086      0.6073      5.082    < 0.001
 7 ex5......................       -0.06127     0.02906     -2.108      0.035

Linear term 1
 8 dgy......................         0.5153      0.1012      5.089    < 0.001

            Records used        11421

                Deviance     5969.143
                     AIC     5981.143
            Pearson Chi2     11244.17      Degrees of freedom   11415



null@
logl 0 +tvlarge @ fit@ 
          Iter  Step      Deviance

             0     0     5969.143
             1     0     5908.840
             2     0     5896.157
             3     0     5896.079
             4     0     5896.079

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.035      0.1264     -24.01    < 0.001
 3 SEX_L_1..................         0.3842     0.07331       5.24    < 0.001
 5 UR_RUR_1.................         0.2486     0.07709      3.225    0.00126
 7 tvlarge_1................          1.003      0.1091      9.193    < 0.001
 8 lage21...................          3.047      0.6087      5.006    < 0.001
 9 ex5......................       -0.06834     0.02915     -2.345      0.019

Linear term 1
10 dgy......................         0.5206      0.1025       5.08    < 0.001

            Records used        11421

                Deviance     5896.079
                     AIC     5910.079
            Pearson Chi2     11231.49      Degrees of freedom   11414



lrt@


!Presence of diffuse goiter as diagnosed at palpation (at 1st screening)

             LR statistic       73.06      Degrees of freedom      1
                  P value     < 0.001

nomodel @
logl 0 sex_l lage21  ex5 ur_rur tvlarge@
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6690.572
             2     0     5967.267
             3     0     5897.736
             4     0     5896.080
             5     0     5896.079
             6     0     5896.079

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.035      0.1264     -24.01    < 0.001
 3 SEX_L_1..................         0.3842     0.07331       5.24    < 0.001
 5 UR_RUR_1.................         0.2486     0.07709      3.225    0.00126
 7 tvlarge_1................          1.003      0.1091      9.193    < 0.001
 8 lage21...................          3.047      0.6087      5.006    < 0.001
 9 ex5......................       -0.06834     0.02915     -2.345      0.019

Linear term 1
10 dgy......................         0.5207      0.1025       5.08    < 0.001

            Records used        11421

                Deviance     5896.079
                     AIC     5910.079
            Pearson Chi2      11231.5      Degrees of freedom   11414



null@
logl 0 +goiter_df_pal @ fit@ 
          Iter  Step      Deviance

             0     0     5896.079
             1     0     5756.275
             2     0     5740.566
             3     0     5740.483
             4     0     5740.483

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.890      0.1272     -22.71    < 0.001
 3 SEX_L_1..................         0.2961     0.07437      3.981    < 0.001
 5 UR_RUR_1.................         0.2269     0.07768      2.921    0.00349
 7 tvlarge_1................         0.5837      0.1159      5.036    < 0.001
 9 goiter_df_pal_1..........          1.135     0.08782      12.93    < 0.001
10 goiter_df_pal_2..........        -0.6069       1.028    -0.5906      > 0.5
11 lage21...................          5.333      0.6504      8.199    < 0.001
12 ex5......................        -0.1670     0.03075     -5.432    < 0.001

Linear term 1
13 dgy......................         0.5199      0.1037      5.011    < 0.001

            Records used        11421

                Deviance     5740.483
                     AIC     5758.483
            Pearson Chi2     11317.34      Degrees of freedom   11412



lrt@


!Family history of any thyroid disease

             LR statistic       155.6      Degrees of freedom      2
                  P value     < 0.001

nomodel @
logl 0 sex_l lage21  ex5 ur_rur tvlarge goiter_df_pal@
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6621.247
             2     0     5835.367
             3     0     5743.510
             4     0     5740.485
             5     0     5740.483
             6     0     5740.483

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.890      0.1272     -22.71    < 0.001
 3 SEX_L_1..................         0.2961     0.07437      3.981    < 0.001
 5 UR_RUR_1.................         0.2269     0.07768      2.921    0.00349
 7 tvlarge_1................         0.5837      0.1159      5.036    < 0.001
 9 goiter_df_pal_1..........          1.135     0.08782      12.93    < 0.001
10 goiter_df_pal_2..........        -0.6069       1.028    -0.5906      > 0.5
11 lage21...................          5.333      0.6504      8.199    < 0.001
12 ex5......................        -0.1670     0.03075     -5.432    < 0.001

Linear term 1
13 dgy......................         0.5199      0.1037      5.011    < 0.001

            Records used        11421

                Deviance     5740.483
                     AIC     5758.483
            Pearson Chi2     11317.36      Degrees of freedom   11412



null@
logl 0 +any_fhf1 @ fit@ 
          Iter  Step      Deviance

             0     0     5740.483
             1     0     5721.898
             2     0     5721.315
             3     0     5721.315
             4     0     5721.315

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.943      0.1283     -22.95    < 0.001
 3 SEX_L_1..................         0.2834      0.0745      3.804    < 0.001
 5 UR_RUR_1.................         0.2166     0.07783      2.783    0.00538
 7 tvlarge_1................         0.5808      0.1161      5.003    < 0.001
 9 goiter_df_pal_1..........          1.117     0.08805      12.68    < 0.001
10 goiter_df_pal_2..........        -0.6577       1.029    -0.6389      > 0.5
12 ANY_FHF1_1...............         0.4953      0.1102      4.494    < 0.001
13 ANY_FHF1_2...............         0.2463      0.2392       1.03      0.303
14 lage21...................          5.265        0.65        8.1    < 0.001
15 ex5......................        -0.1621     0.03074     -5.273    < 0.001

Linear term 1
16 dgy......................         0.5119      0.1031      4.967    < 0.001

            Records used        11421

                Deviance     5721.315
                     AIC     5743.315
            Pearson Chi2     11339.11      Degrees of freedom   11410



lrt@


!Oblast again

             LR statistic       19.17      Degrees of freedom      2
                  P value     < 0.001

nomodel @
logl 0 sex_l lage21  ex5 ur_rur tvlarge goiter_df_pal any_fhf1@
line 1 dgy@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6612.848
             2     0     5819.158
             3     0     5724.522
             4     0     5721.318
             5     0     5721.315
             6     0     5721.315

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.943      0.1283     -22.95    < 0.001
 3 SEX_L_1..................         0.2834      0.0745      3.804    < 0.001
 5 UR_RUR_1.................         0.2166     0.07783      2.783    0.00538
 7 tvlarge_1................         0.5808      0.1161      5.003    < 0.001
 9 goiter_df_pal_1..........          1.117     0.08805      12.68    < 0.001
10 goiter_df_pal_2..........        -0.6577       1.029    -0.6389      > 0.5
12 ANY_FHF1_1...............         0.4953      0.1102      4.494    < 0.001
13 ANY_FHF1_2...............         0.2463      0.2392       1.03      0.303
14 lage21...................          5.265        0.65        8.1    < 0.001
15 ex5......................        -0.1621     0.03074     -5.273    < 0.001

Linear term 1
16 dgy......................         0.5119      0.1031      4.967    < 0.001

            Records used        11421

                Deviance     5721.315
                     AIC     5743.315
            Pearson Chi2     11339.11      Degrees of freedom   11410



null@
logl 0 +obl_mn  @ fit@ 
          Iter  Step      Deviance

             0     0     5721.315
             1     0     5713.892
             2     0     5713.848
             3     0     5713.848

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.978      0.1472     -20.23    < 0.001
 3 SEX_L_1..................         0.2800     0.07458      3.754    < 0.001
 5 UR_RUR_1.................         0.2287     0.08023      2.851    0.00436
 7 tvlarge_1................         0.6148       0.117      5.257    < 0.001
 9 goiter_df_pal_1..........          1.126     0.08819      12.77    < 0.001
10 goiter_df_pal_2..........        -0.6754        1.03    -0.6557      > 0.5
12 ANY_FHF1_1...............         0.4951      0.1102      4.491    < 0.001
13 ANY_FHF1_2...............         0.2511      0.2394      1.049      0.294
15 obl_mn_2.................         0.1203     0.09315      1.292      0.196
16 obl_mn_3.................        -0.1981      0.1398     -1.417      0.156
17 lage21...................          5.327      0.6534      8.153    < 0.001
18 ex5......................        -0.1669     0.03085     -5.411    < 0.001

Linear term 1
19 dgy......................         0.4712      0.1005      4.689    < 0.001

            Records used        11421

                Deviance     5713.848
                     AIC     5739.848
            Pearson Chi2     11339.36      Degrees of freedom   11408



lrt@

             LR statistic       7.467      Degrees of freedom      2
                  P value      0.0239

logl 0 -obl_mn +obl_86n  @ fit@ 
          Iter  Step      Deviance

             0     0     5724.144
             1     0     5714.438
             2     0     5714.400
             3     0     5714.400

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.992      0.1628     -18.38    < 0.001
 3 SEX_L_1..................         0.2824     0.07453      3.789    < 0.001
 5 UR_RUR_1.................         0.2230     0.07948      2.806    0.00502
 7 tvlarge_1................         0.6065      0.1166      5.202    < 0.001
 9 goiter_df_pal_1..........          1.117      0.0881      12.67    < 0.001
10 goiter_df_pal_2..........        -0.6805        1.03    -0.6609      > 0.5
12 ANY_FHF1_1...............         0.4820      0.1103      4.371    < 0.001
13 ANY_FHF1_2...............         0.2241      0.2395     0.9359      0.349
15 obl_86n_2................         0.1356      0.1206      1.124      0.261
16 obl_86n_3................        -0.2072       0.172     -1.205      0.228
17 lage21...................          5.383      0.6526      8.248    < 0.001
18 ex5......................        -0.1689     0.03088     -5.471    < 0.001

Linear term 1
19 dgy......................         0.4562      0.1003      4.549    < 0.001

            Records used        11421

                Deviance       5714.4
                     AIC       5740.4
            Pearson Chi2     11292.64      Degrees of freedom   11408



lrt@ ! Almost the same but obl_86n gives more conservative estimate

!Final background: sex_l lage21  ex5 ur_rur obl_86n tvlarge goiter_df_pal any_fhf1


!Interaction by ex5 and shape of dose response

!Basic linear dose model **** Best model


             LR statistic       6.914      Degrees of freedom      2
                  P value      0.0315

nomodel@
logl 0 sex_l lage21  ex5 ur_rur obl_86n tvlarge goiter_df_pal any_fhf1 @
line 1 dgy@
logl 1 ex5 @
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6609.980
             2     0     5805.073
             3     0     5684.559
             4     0     5677.247
             5     0     5677.115
             6     0     5677.110
             7     0     5677.110
             8     0     5677.110

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.003      0.1659      -18.1    < 0.001
 3 SEX_L_1..................         0.2658     0.07456      3.565    < 0.001
 5 UR_RUR_1.................         0.2142     0.07941      2.697    0.00699
 7 obl_86n_2................         0.1417      0.1203      1.178      0.239
 8 obl_86n_3................        -0.2471       0.173     -1.428      0.153
10 tvlarge_1................         0.6110      0.1171      5.218    < 0.001
12 goiter_df_pal_1..........          1.167      0.0892      13.08    < 0.001
13 goiter_df_pal_2..........        -0.6770        1.03    -0.6572      > 0.5
15 ANY_FHF1_1...............         0.4680      0.1108      4.224    < 0.001
16 ANY_FHF1_2...............         0.2178      0.2402     0.9067      0.365
17 lage21...................          6.554      0.6987       9.38    < 0.001
18 ex5......................        -0.1812     0.03111     -5.824    < 0.001

Linear term 1
19 dgy......................         0.5760      0.1725      3.338    < 0.001

Log-linear term 1
20 ex5......................        -0.3156     0.06687      -4.72    < 0.001

            Records used        11421

                Deviance      5677.11
                     AIC      5705.11
            Pearson Chi2     11353.84      Degrees of freedom   11407



null@


!linear exponential dose-response 

logl 1 +dgy@ 
fit@ 
          Iter  Step      Deviance

             0     0     5677.110
             1     0     5675.955
             2     0     5675.944
             3     0     5675.944
             4     0     5675.944

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.992      0.1656     -18.07    < 0.001
 3 SEX_L_1..................         0.2655     0.07463      3.558    < 0.001
 5 UR_RUR_1.................         0.2150     0.07949      2.705    0.00684
 7 obl_86n_2................         0.1571      0.1203      1.306      0.192
 8 obl_86n_3................        -0.2349      0.1731     -1.357      0.175
10 tvlarge_1................         0.6121      0.1171      5.227    < 0.001
12 goiter_df_pal_1..........          1.167     0.08925      13.07    < 0.001
13 goiter_df_pal_2..........        -0.6675        1.03     -0.648      > 0.5
15 ANY_FHF1_1...............         0.4679      0.1109      4.218    < 0.001
16 ANY_FHF1_2...............         0.2114      0.2414     0.8758      0.381
17 lage21...................          6.482      0.6999      9.262    < 0.001
18 ex5......................        -0.1815     0.03119     -5.818    < 0.001

Linear term 1
19 dgy......................         0.4624      0.1656      2.792    0.00523

Log-linear term 1
20 ex5......................        -0.3170     0.07163     -4.426    < 0.001
21 dgy......................        0.02834     0.02594      1.093      0.275

            Records used        11421

                Deviance     5675.944
                     AIC     5705.944
            Pearson Chi2      11385.3      Degrees of freedom   11406



lrt@ 

!linear quadratic dose-response 


             LR statistic       1.166      Degrees of freedom      1
                  P value       0.280

logl 1 - dgy @
line 1 +dgysq@
fit@  
          Iter  Step      Deviance

             0     0     5678.297
             1     0     5676.426
             2     0     5676.383
             3     0     5676.376
             4     0     5676.374
             5     0     5676.374
             6     0     5676.374

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.995      0.1658     -18.06    < 0.001
 3 SEX_L_1..................         0.2656      0.0746       3.56    < 0.001
 5 UR_RUR_1.................         0.2147     0.07946      2.701    0.00691
 7 obl_86n_2................         0.1522      0.1207      1.261      0.207
 8 obl_86n_3................        -0.2387      0.1733     -1.378      0.168
10 tvlarge_1................         0.6118      0.1171      5.225    < 0.001
12 goiter_df_pal_1..........          1.167     0.08923      13.07    < 0.001
13 goiter_df_pal_2..........        -0.6704        1.03    -0.6507      > 0.5
15 ANY_FHF1_1...............         0.4679      0.1109      4.219    < 0.001
16 ANY_FHF1_2...............         0.2144      0.2408     0.8904      0.373
17 lage21...................          6.506      0.7006      9.285    < 0.001
18 ex5......................        -0.1814     0.03117     -5.822    < 0.001

Linear term 1
19 dgy......................         0.4947      0.1859       2.66     0.0078
20 dgysq....................        0.01101     0.01724     0.6388      > 0.5

Log-linear term 1
21 ex5......................        -0.3166        0.07     -4.523    < 0.001

            Records used        11421

                Deviance     5676.374
                     AIC     5706.374
            Pearson Chi2     11374.61      Degrees of freedom   11406



lrt@


! Final model for Figures 1, 2 


             LR statistic      0.7361      Degrees of freedom      1
                  P value       0.391

nomodel@
logl 0 sex_l lage21  ex5 ur_rur obl_86n tvlarge goiter_df_pal any_fhf1 @
line 1 dgy@
logl 1 ex5@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6609.980
             2     0     5805.073
             3     0     5684.559
             4     0     5677.247
             5     0     5677.115
             6     0     5677.110
             7     0     5677.110
             8     0     5677.110

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.003      0.1659      -18.1    < 0.001
 3 SEX_L_1..................         0.2658     0.07456      3.565    < 0.001
 5 UR_RUR_1.................         0.2142     0.07941      2.697    0.00699
 7 obl_86n_2................         0.1417      0.1203      1.178      0.239
 8 obl_86n_3................        -0.2471       0.173     -1.428      0.153
10 tvlarge_1................         0.6110      0.1171      5.218    < 0.001
12 goiter_df_pal_1..........          1.167      0.0892      13.08    < 0.001
13 goiter_df_pal_2..........        -0.6770        1.03    -0.6572      > 0.5
15 ANY_FHF1_1...............         0.4680      0.1108      4.224    < 0.001
16 ANY_FHF1_2...............         0.2178      0.2402     0.9067      0.365
17 lage21...................          6.554      0.6987       9.38    < 0.001
18 ex5......................        -0.1812     0.03111     -5.824    < 0.001

Linear term 1
19 dgy......................         0.5760      0.1725      3.338    < 0.001

Log-linear term 1
20 ex5......................        -0.3156     0.06687      -4.72    < 0.001

            Records used        11421

                Deviance      5677.11
                     AIC      5705.11
            Pearson Chi2     11353.84      Degrees of freedom   11407




bounds 19@ !Figure 1 Dose reasponse plot at age 5
      Profile likelihood bounds for parameter 19 (dgy)

                  MLE      0.576

               97.5% lower bound      0.2289
               97.5% upper bound       1.015


bounds 20@ !Figure 2 Age at exposure plot
      Profile likelihood bounds for parameter 20 (ex5)

                  MLE    -0.3156    exp(MLE)     0.7293

               97.5% lower bound     -0.5311
                       exp(bound)     0.5879
               97.5% upper bound     -0.1902
                       exp(bound)     0.8268




! Points and CIs for Figure 1 all - add 1 to estimate and CIs

nomodel@
logl 0 sex_l lage21  ex5 ur_rur obl_86n tvlarge goiter_df_pal any_fhf1 @
line 1 dct7@
logl 1 ex5@
para 19=0@
fit@ 
          Iter  Step      Deviance

             0     0    15832.868
             1     0     6619.899
             2     0     5814.223
             3     0     5691.823
             4     0     5683.724
             5     0     5683.632
             6     0     5683.632

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -2.992      0.1683     -17.77    < 0.001
 3 SEX_L_1..................         0.2702     0.07451      3.626    < 0.001
 5 UR_RUR_1.................         0.2124     0.07939      2.676    0.00746
 7 obl_86n_2................         0.1226      0.1247     0.9828      0.326
 8 obl_86n_3................        -0.2585      0.1753     -1.474       0.14
10 tvlarge_1................         0.6076      0.1171      5.187    < 0.001
12 goiter_df_pal_1..........          1.163     0.08911      13.05    < 0.001
13 goiter_df_pal_2..........        -0.7374       1.032    -0.7142      0.475
15 ANY_FHF1_1...............         0.4687      0.1107      4.234    < 0.001
16 ANY_FHF1_2...............         0.2378      0.2392      0.994       0.32
17 lage21...................          6.657      0.7021      9.482    < 0.001
18 ex5......................        -0.1845     0.03118     -5.918    < 0.001

Linear term 1
19 dct7_1...................          0.000       Fixed     -0.1804      > 0.5
20 dct7_2...................        0.03136      0.1365     0.2297      > 0.5
21 dct7_3...................         0.2884       0.191       1.51      0.131
22 dct7_4...................         0.4201      0.2274      1.847     0.0647
23 dct7_5...................          1.429      0.4634      3.084    0.00204
24 dct7_6...................          1.124      0.4711      2.387      0.017
25 dct7_7...................          4.406        1.39      3.169    0.00153

Log-linear term 1
26 ex5......................        -0.3041     0.05755     -5.284    < 0.001

            Records used        11421

                Deviance     5683.632
                     AIC     5721.632
            Pearson Chi2     11384.25      Degrees of freedom   11402




bounds 20@ 
      Profile likelihood bounds for parameter 20 (dct7_2)

                  MLE    0.03136

               97.5% lower bound     -0.1861
               97.5% upper bound      0.4101


bounds 21@ 
      Profile likelihood bounds for parameter 21 (dct7_3)

                  MLE     0.2884

               97.5% lower bound    0.008276
               97.5% upper bound      0.7593


bounds 22@ 
      Profile likelihood bounds for parameter 22 (dct7_4)

                  MLE     0.4201

               97.5% lower bound     0.07432
               97.5% upper bound      0.9883


bounds 23@ 
      Profile likelihood bounds for parameter 23 (dct7_5)

                  MLE      1.429

               97.5% lower bound      0.6194
               97.5% upper bound       2.563


bounds 24@ 
      Profile likelihood bounds for parameter 24 (dct7_6)

                  MLE      1.124

               97.5% lower bound      0.4459
               97.5% upper bound       2.247


bounds 25@ 
      Profile likelihood bounds for parameter 25 (dct7_7)

                  MLE      4.406

               97.5% lower bound       1.992
               97.5% upper bound        8.09




! Points and CIs for Figure 2 all - add 1 to estimate and CIs

nomodel@
logl 0 sex_l lage21  exct4 ur_rur obl_86n tvlarge goiter_df_pal any_fhf1 @
line 1 dgy@
logl 1 exct4@
para 22=1@
fit@ 
          Iter  Step      Deviance

             0     0    20257.966
             1     0     7342.075
             2     1     6827.848
             3     0     5872.178
             4     0     5728.004
             5     0     5717.775
             6     0     5717.271
             7     0     5717.222
             8     0     5717.216
             9     0     5717.215
            10     0     5717.215

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -4.212      0.7228     -5.827    < 0.001
 3 SEX_L_1..................         0.2830     0.07457      3.795    < 0.001
 5 exct4_2..................         0.4910      0.8142      0.603      > 0.5
 6 exct4_3..................         0.6719      0.7213     0.9315      0.352
 7 exct4_4..................         0.7582      0.7194      1.054      0.292
 9 UR_RUR_1.................         0.2192     0.07926      2.766    0.00568
11 obl_86n_2................         0.1202      0.1202          1      0.317
12 obl_86n_3................        -0.1878      0.1725     -1.088      0.276
14 tvlarge_1................         0.6402      0.1163      5.503    < 0.001
16 goiter_df_pal_1..........          1.001     0.08472      11.81    < 0.001
17 goiter_df_pal_2..........        -0.5042       1.028    -0.4905      > 0.5
19 ANY_FHF1_1...............         0.4935      0.1103      4.477    < 0.001
20 ANY_FHF1_2...............         0.2665      0.2407      1.107      0.268
21 lage21...................          2.353      0.2593      9.072    < 0.001

Linear term 1
22 dgy......................          1.000     Aliased

Log-linear term 1
23 exct4_1..................          1.097      0.9063      1.211      0.226
24 exct4_2..................         0.4548      0.6013     0.7563      0.449
25 exct4_3..................        -0.4833       0.402     -1.202      0.229
26 exct4_4..................         -1.998      0.5547     -3.602    < 0.001

            Records used        11421

                Deviance     5717.215
                     AIC     5753.215
            Pearson Chi2     11354.53      Degrees of freedom   11403




bounds 23@ 
      Profile likelihood bounds for parameter 23 (exct4_1)

                  MLE      1.097    exp(MLE)      2.996

               97.5% lower bound     -0.7239
                       exp(bound)     0.4848
               97.5% upper bound not found last estimate       29.3 Deviance 18189.145


 *** WARNING: Parameter exct4_3 changed by -18682602.-7% MLE may be infinite or may not exist


bounds 24@ 
      Profile likelihood bounds for parameter 24 (exct4_2)

                  MLE     0.4548    exp(MLE)      1.576

               97.5% lower bound     -0.6017
                       exp(bound)     0.5479
               97.5% upper bound        1.78
                       exp(bound)       5.93


bounds 25@ 
      Profile likelihood bounds for parameter 25 (exct4_3)

                  MLE    -0.4833    exp(MLE)     0.6167

               97.5% lower bound      -1.429
                       exp(bound)     0.2395
               97.5% upper bound      0.2825
                       exp(bound)      1.326


bounds 26@
      Profile likelihood bounds for parameter 26 (exct4_4)

                  MLE     -1.998    exp(MLE)     0.1356

               97.5% lower bound      -4.366
                       exp(bound)     0.0127
               97.5% upper bound      -1.194
                       exp(bound)     0.3031




mean age_exp; by exct4@
           Summary for AGE_EXP

exct4          Mean      Std. Dev.        Count      Minimum      Maximum
    1      0.563863       0.27703           634    0.0027379      0.99658
    2       1.50060       0.29237           782       1.0021       1.9959
    3       3.50205       0.85406          2293       2.0014       4.9993
    4       10.9073        3.6268          7712       5.0021       17.999


