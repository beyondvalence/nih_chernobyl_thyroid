! Table 2 categorical dose response ORs
! remember to add 1 to estimate and lower and upper cis


new @


names 
IDN	
byear AGE_EXM	AGE_EXP	YEAR_EXM 
SEX_L	
OBL_M	OBL_86	UR_RUR	ur_rur86
thnod_prev	max_size nod_sz nod_sz3 thcount nod_neohc nod_neo
tc	prevcases FA_PREV 
DOSE_GYAV_S		
IODINE	tvolume TSH	TG	atg 
SMOKE_F	VITAM_F		
AIT_TOTF goiter_df_pal NDG_RELF ANY_FHF1
Cytology CytologyRecomend Operat OperatRecomend RefOnko fnb
@


skip 1 @

input 'E:\NCI\IR_Nod_Prev_BelAm\Data\dose_tnprev_belam_exclude1.csv' @

Input from E:\NCI\IR_Nod_Prev_BelAm\Data\dose_tnprev_belam_exclude1.csv

       11422 records read       11421 records used
                                    1 records rejected

40 variables defined  At least 500 additional variables can be created.


!input 'C:\REB\chernobyl_thyroid\Data\dose_tnprev_belam_exclude1.csv' @

tran dgy=dose_gyav_s;
     dgysq=dgy*dgy;
     ex2=(age_exp-2);
     ex4=(age_exp-4);
     ex5=(age_exp-5);
     ex8=(age_exp-8);
     ex8sq=ex8*ex8;
     age21=(age_exm-21);
     age21sq=age21*age21;
     lage21 = log(age_exm/21) ;
     lage21sq = lage21^2 ;
     tvol13=(tvolume-13);
     tvol13sq=tvol13*tvol13;
     yob1983=(byear-1983);

     if any_fhf1==-1 then any_fhf1=2 !2 recoded to missing
     endif; 

     if smoke_f==-1 then smoke_f=2
     endif;
     
     if ismiss(goiter_df_pal)==1 then goiter_df_pal=2
     endif;


     if obl_m==1 then obl_mn=2 !Gomel
     elif obl_m==2 or obl_m==4 then obl_mn=1 !Minsk
     else obl_mn=3 !Mogilev and others
     endif;

     if obl_86==1 then obl_86n=2 !Gomel
     elif obl_86==2 or obl_86==4 then obl_86n=1 !Minsk
     else obl_86n=3 !Mogilev and others
     endif;

     if ur_rur86==1 then ur_rur86n=1 !Rural
     elif ur_rur86==2 or ur_rur86==3 or ur_rur86==4 then ur_rur86n=2 !Urban
     endif;

     if tvolume>=18 and sex_l==1 then tvlarge=1 !Thyroid enlargement for women
     elif tvolume>=25 and sex_l==0 then tvlarge=1  !Thyroid enlargement for men
     else tvlarge=0 !Normal thyroid
     endif;

     iod100=(iodine-100);
     iod60=(iodine-60);
     iodinen=iodine;
     if ismiss(iodine)==1 then iodinen=9999
     endif; 


@

 
levels   
SEX_L	 
OBL_M	obl_mn OBL_86 obl_86n	UR_RUR	ur_rur86 ur_rur86n
thnod_prev nod_sz nod_sz3 thcount nod_neohc nod_neo
tc	prevcases FA_PREV 
SMOKE_F	VITAM_F		
AIT_TOTF goiter_df_pal NDG_RELF ANY_FHF1
Cytology CytologyRecomend Operat OperatRecomend RefOnko fnb
tvlarge 
@

SEX_L has 2 levels from 0 to 1
OBL_M has 5 levels from 1 to 5
obl_mn has 3 levels from 1 to 3
OBL_86 has 8 levels from 1 to 8
obl_86n has 3 levels from 1 to 3
UR_RUR has 2 levels from 0 to 1
ur_rur86 has 4 levels from 1 to 4
ur_rur86n has 2 levels from 1 to 2
thnod_prev has 2 levels from 0 to 1
nod_sz has 3 levels from 0 to 2
nod_sz3 has 4 levels from 0 to 3
thcount has 5 levels from 0 to 4
nod_neohc has 2 levels from 0 to 1
nod_neo has 2 levels from 0 to 1
tc has 4 levels from 0 to 3
prevcases has 2 levels from 0 to 1
FA_PREV has 2 levels from 0 to 1
SMOKE_F has 3 levels from 0 to 2
VITAM_F has 2 levels from 0 to 1
AIT_TOTF has 3 levels from -1 to 1
goiter_df_pal has 3 levels from 0 to 2
NDG_RELF has 3 levels from -1 to 1
ANY_FHF1 has 3 levels from 0 to 2
Cytology has 2 levels from 1 to 2
CytologyRecomend has 2 levels from 0 to 1
Operat has 2 levels from 1 to 2
OperatRecomend has 2 levels from 0 to 1
RefOnko has 4 levels from 0 to 3
fnb has 3 levels from 1 to 3
tvlarge has 2 levels from 0 to 1

categ byear as dobyrct </1973/ 1978/ 1983/ 1987/ > @

dobyrct has 5 levels from 1 to 5

categ age_exm as agect </ 18/ 25/ > @

agect has 3 levels from 1 to 3

categ age_exp as exct </2/5/ > @ 

exct has 3 levels from 1 to 3

categ year_exm as yearexmct </ 1998/ 1999/ 2000/ 2001/> @

yearexmct has 5 levels from 1 to 5

categ tvolume as tvct </ 8/ 10/ 14/ > @

tvct has 4 levels from 1 to 4

categ iodinen as iodct </20/9998> @

iodct has 3 levels from 1 to 3

categ dgy as dct7  </ 0.1000/ 0.2500/ 0.500/ 1.000/ 2.000/ 4.000/> @

dct7 has 7 levels from 1 to 7


tran 
if        dct7==1 then dct7num=1
     elif dct7==2 then dct7num=2
     elif dct7==3 then dct7num=3
     elif dct7==4 then dct7num=4
     elif dct7==5 then dct7num=5
     elif dct7==6 then dct7num=6
     else              dct7num=7
     endif;

@


cases thnod_prev @

!All
freq dct7 thnod_prev @

Entries:
         count

             thnod_prev
dct7       |         0         1 |  Total
-----------+---------------------+----------
      1    |      2972       231 |      3203
      2    |      2138       169 |      2307
      3    |      1961       158 |      2119
      4    |      1682       129 |      1811
      5    |      1076       110 |      1186
      6    |       503        40 |       543
      7    |       208        44 |       252
-----------+---------------------+----------
     Total |     10540       881 |     11421



nomodel@
logl 0 sex_l lage21 obl_86n ur_rur @ 

line 1 dct7 @ 

logl 1 ex5@

para 11=0@

fit@

          Iter  Step      Deviance

             0     0    15832.868
             1     0     6742.284
             2     0     6036.415
             3     0     5954.598
             4     0     5949.774
             5     0     5949.678
             6     0     5949.674
             7     0     5949.673
             8     0     5949.673

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.243       0.162     -20.01    < 0.001
 3 SEX_L_1..................         0.4319     0.07255      5.953    < 0.001
 5 obl_86n_2................        0.08487      0.1251     0.6786      0.497
 6 obl_86n_3................        -0.1946      0.1722      -1.13      0.259
 8 UR_RUR_1.................         0.2181     0.07808      2.793    0.00523
 9 lage21...................          2.556      0.2762      9.255    < 0.001

Linear term 1
10 dct7_1...................       -0.02097       0.152     -0.138      > 0.5
11 dct7_2...................          0.000       Fixed       0.121      > 0.5
12 dct7_3...................         0.3149       0.211      1.492      0.136
13 dct7_4...................         0.3737      0.2269      1.647     0.0996
14 dct7_5...................          1.363      0.4199      3.247    0.00117
15 dct7_6...................          1.027      0.4372      2.349     0.0188
16 dct7_7...................          4.539       1.284      3.534    < 0.001

Log-linear term 1
17 ex5......................        -0.2087     0.04695     -4.445    < 0.001

            Records used        11421

                Deviance     5949.673
                     AIC     5975.673
            Pearson Chi2     11272.99      Degrees of freedom   11408




cases thnod_prev @

!All
freq dct7 thnod_prev @

Entries:
         count

             thnod_prev
dct7       |         0         1 |  Total
-----------+---------------------+----------
      1    |      2972       231 |      3203
      2    |      2138       169 |      2307
      3    |      1961       158 |      2119
      4    |      1682       129 |      1811
      5    |      1076       110 |      1186
      6    |       503        40 |       543
      7    |       208        44 |       252
-----------+---------------------+----------
     Total |     10540       881 |     11421



nomodel@
logl 0 sex_l lage21 obl_86n ur_rur @ 

line 1 dct7 @ 

logl 1 ex5@

cases thnod_prev @

!All
freq dct7 thnod_prev @

Entries:
         count

             thnod_prev
dct7       |         0         1 |  Total
-----------+---------------------+----------
      1    |      2972       231 |      3203
      2    |      2138       169 |      2307
      3    |      1961       158 |      2119
      4    |      1682       129 |      1811
      5    |      1076       110 |      1186
      6    |       503        40 |       543
      7    |       208        44 |       252
-----------+---------------------+----------
     Total |     10540       881 |     11421



nomodel@
logl 0 sex_l lage21 obl_mn ur_rur @ 

line 1 dct7 @ 

logl 1 ex5@

para 10=0@

fit@

          Iter  Step      Deviance

             0     0    15832.868
             1     0     6742.461
             2     0     6040.120
             3     0     5957.594
             4     0     5952.321
             5     0     5952.228
             6     0     5952.226
             7     0     5952.226

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.226      0.1245     -25.91    < 0.001
 3 SEX_L_1..................         0.4324     0.07256      5.959    < 0.001
 5 obl_mn_2.................       0.006102     0.09455    0.06453      > 0.5
 6 obl_mn_3.................        -0.1573      0.1394     -1.128      0.259
 8 UR_RUR_1.................         0.2148     0.07896       2.72    0.00653
 9 lage21...................          2.670      0.2774      9.627    < 0.001

Linear term 1
10 dct7_1...................          0.000       Fixed    -0.01509      > 0.5
11 dct7_2...................        0.07775      0.1715     0.4535      > 0.5
12 dct7_3...................         0.4114      0.2289      1.797     0.0723
13 dct7_4...................         0.4894        0.25      1.957     0.0503
14 dct7_5...................          1.594      0.4588      3.475    < 0.001
15 dct7_6...................          1.208      0.4821      2.506     0.0122
16 dct7_7...................          5.172       1.423      3.634    < 0.001

Log-linear term 1
17 ex5......................        -0.2030      0.0434     -4.677    < 0.001

            Records used        11421

                Deviance     5952.226
                     AIC     5978.226
            Pearson Chi2     11269.32      Degrees of freedom   11408




bounds 11@

      Profile likelihood bounds for parameter 11 (dct7_2)

                  MLE    0.07775

               97.5% lower bound     -0.2119
               97.5% upper bound      0.5166


!categorical dose response p-value
nomodel@
logl 0 sex_l lage21 obl_mn ur_rur @

logl 1 ex5 @

fit@ 
          Iter  Step      Deviance

             0     0    23873.177
             1     0     6389.610
             2     0     6070.312
             3     0     6047.295
             4     0     6046.376
             5     0     6043.329
             6     0     6043.215
             7     0     6043.215

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.434      0.1088     -31.57    < 0.001
 3 SEX_L_1..................         0.4103     0.07217      5.685    < 0.001
 5 obl_mn_2.................         0.1550     0.08999      1.722     0.0851
 6 obl_mn_3.................        -0.1017      0.1375    -0.7399      0.459
 8 UR_RUR_1.................        0.08787     0.07675      1.145      0.252
 9 lage21...................          2.859      0.2733      10.46    < 0.001

Log-linear term 1
10 ex5......................        -0.1988     0.05317     -3.738    < 0.001

            Records used        11421

                Deviance     6043.215
                     AIC     6057.215
            Pearson Chi2     11409.08      Degrees of freedom   11414



null@
line 1 +dct7num@ 

fit@ 
          Iter  Step      Deviance

             0     0     6226.483
             1     0     6040.483
             2     0     5988.709
             3     0     5983.450
             4     0     5983.410
             5     0     5983.407
             6     0     5983.407
             7     0     5983.407

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.529      0.1758     -20.08    < 0.001
 3 SEX_L_1..................         0.4278     0.07237      5.911    < 0.001
 5 obl_mn_2.................       -0.01203     0.09328    -0.1289      > 0.5
 6 obl_mn_3.................        -0.2017      0.1386     -1.455      0.146
 8 UR_RUR_1.................         0.1870     0.07818      2.391     0.0168
 9 lage21...................          3.408      0.4179      8.155    < 0.001

Linear term 1
10 dct7num..................         0.5011      0.1756      2.854    0.00432

Log-linear term 1
11 ex5......................        -0.2142     0.03751     -5.711    < 0.001

            Records used        11421

                Deviance     5983.407
                     AIC     5999.407
            Pearson Chi2     11141.76      Degrees of freedom   11413



lrt@

!Benign


             LR statistic       59.81      Degrees of freedom      1
                  P value     < 0.001

