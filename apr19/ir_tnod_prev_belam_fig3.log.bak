! Figure 3
! Model building for < 4Gy, centered at ex=2


new @


names 
IDN	
byear AGE_EXM	AGE_EXP	YEAR_EXM 
SEX_L	
OBL_M	OBL_86	UR_RUR	ur_rur86
thnod_prev	max_size nod_sz nod_sz3 thcount nod_neohc nod_neo
tc	prevcases FA_PREV 
DOSE_GYAV_S		
IODINE	tvolume TSH	TG	atg 
SMOKE_F	VITAM_F		
AIT_TOTF goiter_df_pal NDG_RELF ANY_FHF1
Cytology CytologyRecomend Operat OperatRecomend RefOnko fnb
@


skip 1 @

input 'E:\NCI\IR_Nod_Prev_BelAm\Data\dose_tnprev_belam_exclude1.csv' @

Input from E:\NCI\IR_Nod_Prev_BelAm\Data\dose_tnprev_belam_exclude1.csv

       11422 records read       11421 records used
                                    1 records rejected

40 variables defined  At least 500 additional variables can be created.



tran dgy=dose_gyav_s;
     dgysq=dgy*dgy;
     ex2=(age_exp-2);
     ex4=(age_exp-4);
     ex5=(age_exp-5);
     ex8=(age_exp-8);
     ex8sq=ex8*ex8;
     age21=(age_exm-21);
     age21sq=age21*age21;
     lage21 = log(age_exm/21) ;
     lage21sq = lage21^2 ;
     tvol13=(tvolume-13);
     tvol13sq=tvol13*tvol13;
     yob1983=(byear-1983);

     if any_fhf1==-1 then any_fhf1=2 !2 recoded to missing
     endif; 

     if smoke_f==-1 then smoke_f=2
     endif;
     
     if ismiss(goiter_df_pal)==1 then goiter_df_pal=2
     endif;


     if obl_m==1 then obl_mn=2 !Gomel
     elif obl_m==2 or obl_m==4 then obl_mn=1 !Minsk
     else obl_mn=3 !Mogilev and others
     endif;

     if obl_86==1 then obl_86n=2 !Gomel
     elif obl_86==2 or obl_86==4 then obl_86n=1 !Minsk
     else obl_86n=3 !Mogilev and others
     endif;

     if ur_rur86==1 then ur_rur86n=1 !Rural
     elif ur_rur86==2 or ur_rur86==3 or ur_rur86==4 then ur_rur86n=2 !Urban
     endif;

     if tvolume>=18 and sex_l==1 then tvlarge=1 !Thyroid enlargement for women
     elif tvolume>=25 and sex_l==0 then tvlarge=1  !Thyroid enlargement for men
     else tvlarge=0 !Normal thyroid
     endif;

     iod100=(iodine-100);
     iod60=(iodine-60);
     iodinen=iodine;
     if ismiss(iodine)==1 then iodinen=9999
     endif; 


@

 
levels   
SEX_L	 
OBL_M	obl_mn OBL_86 obl_86n	UR_RUR	ur_rur86 ur_rur86n
thnod_prev nod_sz nod_sz3 thcount nod_neohc nod_neo
tc	prevcases FA_PREV 
SMOKE_F	VITAM_F		
AIT_TOTF goiter_df_pal NDG_RELF ANY_FHF1
Cytology CytologyRecomend Operat OperatRecomend RefOnko fnb
tvlarge 
@

SEX_L has 2 levels from 0 to 1
OBL_M has 5 levels from 1 to 5
obl_mn has 3 levels from 1 to 3
OBL_86 has 8 levels from 1 to 8
obl_86n has 3 levels from 1 to 3
UR_RUR has 2 levels from 0 to 1
ur_rur86 has 4 levels from 1 to 4
ur_rur86n has 2 levels from 1 to 2
thnod_prev has 2 levels from 0 to 1
nod_sz has 3 levels from 0 to 2
nod_sz3 has 4 levels from 0 to 3
thcount has 5 levels from 0 to 4
nod_neohc has 2 levels from 0 to 1
nod_neo has 2 levels from 0 to 1
tc has 4 levels from 0 to 3
prevcases has 2 levels from 0 to 1
FA_PREV has 2 levels from 0 to 1
SMOKE_F has 3 levels from 0 to 2
VITAM_F has 2 levels from 0 to 1
AIT_TOTF has 3 levels from -1 to 1
goiter_df_pal has 3 levels from 0 to 2
NDG_RELF has 3 levels from -1 to 1
ANY_FHF1 has 3 levels from 0 to 2
Cytology has 2 levels from 1 to 2
CytologyRecomend has 2 levels from 0 to 1
Operat has 2 levels from 1 to 2
OperatRecomend has 2 levels from 0 to 1
RefOnko has 4 levels from 0 to 3
fnb has 3 levels from 1 to 3
tvlarge has 2 levels from 0 to 1

categ byear as dobyrct </1973/ 1978/ 1983/ 1987/ > @

dobyrct has 5 levels from 1 to 5

categ age_exm as agect </ 18/ 25/ > @

agect has 3 levels from 1 to 3

categ age_exp as exct </2/5/ > @ 

exct has 3 levels from 1 to 3

categ year_exm as yearexmct </ 1998/ 1999/ 2000/ 2001/> @

yearexmct has 5 levels from 1 to 5

categ tvolume as tvct </ 8/ 10/ 14/ > @

tvct has 4 levels from 1 to 4

categ iodinen as iodct </20/9998> @

iodct has 3 levels from 1 to 3

categ dgy as dct7  </ 0.1000/ 0.2500/ 0.500/ 1.000/ 2.000/ 4.000/> @

dct7 has 7 levels from 1 to 7



cases thnod_prev@

!!! All

select dgy<4@

11169 records to be used


freq thnod_prev @


Using dgy<4

  FOR: thnod_prev
  Level     Freq     %      Cum %
      0       10332   92.51    92.51
      1         837    7.49   100.00
  Total       11169




!Basic linear dose model 
nomodel@
logl 0 sex_l lage21  ur_rur obl_mn   @

line 1 dgy@

logl 1 ex2 @

fit@ 
          Iter  Step      Deviance

             0     0    15483.522
             1     0     6513.429
             2     0     5802.041
             3     0     5756.526
             4     0     5732.542
             5     0     5731.526
             6     0     5731.522
             7     0     5731.522

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

Using dgy<4

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.195      0.1201      -26.6    < 0.001
 3 SEX_L_1..................         0.4249     0.07434      5.715    < 0.001
 5 UR_RUR_1.................         0.2157       0.081      2.663    0.00775
 7 obl_mn_2.................        0.01821     0.09331     0.1951      > 0.5
 8 obl_mn_3.................        -0.1659        0.14     -1.185      0.236
 9 lage21...................          2.563      0.2355      10.88    < 0.001

Linear term 1
10 dgy......................          1.229        0.36      3.414    < 0.001

Log-linear term 1
11 ex2......................        -0.2123      0.0596     -3.561    < 0.001

            Records used        11169

                Deviance     5731.522
                     AIC     5747.522
            Pearson Chi2     11012.89      Degrees of freedom   11161



null@

!linear quadratic dose-response 
line 1 +dgysq @ 

fit @ 
          Iter  Step      Deviance

             0     0     5731.522
             1     0     5729.719
             2     0     5729.665
             3     0     5729.664
             4     0     5729.664

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

Using dgy<4

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.242      0.1261     -25.71    < 0.001
 3 SEX_L_1..................         0.4261     0.07432      5.732    < 0.001
 5 UR_RUR_1.................         0.2214     0.08108       2.73    0.00633
 7 obl_mn_2.................      -0.002594     0.09453   -0.02744      > 0.5
 8 obl_mn_3.................        -0.1838      0.1406     -1.307      0.191
 9 lage21...................          2.709      0.2704      10.02    < 0.001

Linear term 1
10 dgy......................          2.072      0.8296      2.498     0.0125
11 dgysq....................        -0.3219      0.2496     -1.289      0.197

Log-linear term 1
12 ex2......................        -0.2076     0.05325     -3.898    < 0.001

            Records used        11169

                Deviance     5729.664
                     AIC     5747.664
            Pearson Chi2     10984.12      Degrees of freedom   11160



lrt @

!linear exponential dose-response

             LR statistic       1.858      Degrees of freedom      1
                  P value       0.173

line 1 -dgysq@

logl 1 +dgy @

fit@  
          Iter  Step      Deviance

             0     0     5738.726
             1     0     5730.029
             2     0     5729.781
             3     0     5729.780
             4     0     5729.780

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

Using dgy<4

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.245       0.128     -25.34    < 0.001
 3 SEX_L_1..................         0.4262     0.07432      5.735    < 0.001
 5 UR_RUR_1.................         0.2214     0.08108      2.731    0.00632
 7 obl_mn_2.................      -0.003736     0.09497   -0.03934      > 0.5
 8 obl_mn_3.................        -0.1849      0.1409     -1.312      0.189
 9 lage21...................          2.717      0.2804      9.692    < 0.001

Linear term 1
10 dgy......................          2.189       1.047       2.09     0.0366

Log-linear term 1
11 ex2......................        -0.2072     0.05307     -3.904    < 0.001
12 dgy......................        -0.2212        0.16     -1.382      0.167

            Records used        11169

                Deviance      5729.78
                     AIC      5747.78
            Pearson Chi2     10984.67      Degrees of freedom   11160



lrt@

!Final model Figure 3 <4 Gy

             LR statistic       1.742      Degrees of freedom      1
                  P value       0.187

nomodel@
logl 0 sex_l lage21  ur_rur obl_mn   @

line 1 dgy@

logl 1 ex2 @

fit@ 

          Iter  Step      Deviance

             0     0    15483.522
             1     0     6513.429
             2     0     5802.041
             3     0     5756.526
             4     0     5732.542
             5     0     5731.526
             6     0     5731.522
             7     0     5731.522

Binomial odds regression
Additive excess relative risk T0 * (1 + T1 + T2 + ...)

Using dgy<4

thnod_prev is used for cases
Bernoulli trials


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 %CON.....................         -3.195      0.1201      -26.6    < 0.001
 3 SEX_L_1..................         0.4249     0.07434      5.715    < 0.001
 5 UR_RUR_1.................         0.2157       0.081      2.663    0.00775
 7 obl_mn_2.................        0.01821     0.09331     0.1951      > 0.5
 8 obl_mn_3.................        -0.1659        0.14     -1.185      0.236
 9 lage21...................          2.563      0.2355      10.88    < 0.001

Linear term 1
10 dgy......................          1.229        0.36      3.414    < 0.001

Log-linear term 1
11 ex2......................        -0.2123      0.0596     -3.561    < 0.001

            Records used        11169

                Deviance     5731.522
                     AIC     5747.522
            Pearson Chi2     11012.89      Degrees of freedom   11161



